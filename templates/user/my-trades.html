{% extends "layout.html" %}
{% set active_page = 'my-trades' %}
{% block content %}
<style>
span {
    color: #187aa3;
    font-weight: bold;
}
</style>

<p></p>
<div class="container m-6 w-75">
    <div class="row">
        <div class="col-5 p-4 mx-auto">
            <h2 class="text-center"> Trade Requests Awaiting Your Approval </h2>
            {% for trade in trade_info %}
            {% if trade["StatusId"] == 2 %}
            <p></p>
            <div class="card">
                <div class="card-body">
                    <p><span> Title:</span> {{ trade["Title"] }}</p>
                    <p><span>Book Quality:</span> {{ trade["Quality"] }}</p>
                    <p><span>Points for Trade:</span> {{ trade["Points"] }}</p>
                    <p><span>Requesting User:</span> {{ trade["Requester"] }}</p>
                    <p><span>Requesting User Stats:</span></p>
                    <!-- the below buttons are currently non-functional; update coming in sprint 5 -->
                    <div class="text-center">
                        <form>
                            <button type="submit" class="btn btn-primary btn-sm"
                                                  formaction="***Add button functionality***">Accept
                            </button>
                            <button type="submit" class="btn btn-secondary btn-sm"
                                                  onclick='rejectTradeRequest( {{ trade | tojson }})'>Reject
                            </button>
                        </form>
                    </div>
                </div>
            </div>
            {% endif %}
            {% endfor %}
        </div>
                                                  
        <div class="col-5 p-4 mx-auto">
            <h2 class="text-center"> Accepted Trade Requests Not Yet Received </h2>
            {% for trade in trade_info %}
            {% if trade["StatusId"] == 3 %}
            <div class="card">
                <div class="card-body">
                    <p><span> Title: </span> {{ trade["Title"] }}</p>
                    <p><span>Book Quality:</span> {{ trade["Quality"] }}</p>
                    <p><span>Points for Trade:</span> {{ trade["Points"] }}</p>
                    <p><span>Requesting User:</span> {{ trade["Requester"] }}</p>
                    <p><span>Requesting User Stats:</span></p>
                    <!-- the below button is currently non-functional; update coming in sprint 5 -->
                    <form>
                        <button type="submit" class="btn btn-primary btn-sm"
                                              formaction="***Add button functionality in sprint 5***">Cancel Trade
                        </button>
                    </form>
                </div>
            </div>
            {% endif %}
            {% endfor %}
        </div>
    </div>
</div>

<div class="modal" tabindex="-1" role="dialog" id="rejectModal">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Reject Trade Request Confirmation</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body text-left">
                <p> You are about to reject the trade request for 
                <span class="text-info" id="rejectModalTitle"> </span>
                by
                <span class='text-info' id="rejectModalAuthor"> </span>
                (ISBN: 
                <span class='text-info' id="rejectModalISBN"> </span>
                ).  This request was made by user
                <span class='text-info' id='rejectModalUsername'> </span>
                </p>
                <p> If you instead decide to accept this request, you would 
                earn
                <span class='text-info' id="rejectModalPoints">
                </span>.
                </p>
                <p> 
                Are you certain you would like to reject the request?
                </p>
                <div class="col-12 mb-4">
                    <div class="card text-center h-100">
                        <div class="card-body">
                            <img class="card-img-top img-fluid mx-auto"
                                 src="{{ url_for('static', filename='images/book.png') }}"
                                 style="max-width: 75%">
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <form id="rejectModalConfirmForm">
                    <div class="form-group">
                        <button id='requestTradeModalConfirmationButton' type="submit" class="btn btn-primary">
                            Yes, Please Reject The Trade Request
                        </button>
                        <button type="button" class="btn btn-secondary" data-dismiss="modal">
                            Cancel
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

    <script type="text/javascript" src="{{ url_for('static', filename='js/my-trades.js') }}">
    </script>
{% endblock content %}
